{% extends "form.njk" %}

{% from "share-preview/macro.njk" import sharePreview %}

{% block fieldset %}
  {# Type selector — radio buttons #}
  <fieldset class="field">
    <legend class="label">{{ __("share.type.label") }}</legend>
    <div style="display: flex; gap: 1rem; margin-bottom: 0.5rem;">
      <label style="display: flex; align-items: center; gap: 0.25rem; cursor: pointer;">
        <input type="radio" name="type" value="bookmark" {{ "checked" if shareType != "note" }}>
        {{ __("share.type.bookmark") }}
      </label>
      <label style="display: flex; align-items: center; gap: 0.25rem; cursor: pointer;">
        <input type="radio" name="type" value="note" {{ "checked" if shareType == "note" }}>
        {{ __("share.type.note") }}
      </label>
    </div>
  </fieldset>

  {{ sharePreview({
    title: {
      for: "name",
      value: name,
      placeholder: __("share.name.label")
    },
    text: {
      for: "content",
      value: content,
      placeholder: __("share.content.label")
    },
    url: {
      for: "bookmark-of",
      value: bookmarkOf or url,
      placeholder: __("share.bookmark-of.label")
    },
    date: "now",
    locale: application.locale
  }) }}

  {{ input({
    name: "bookmark-of",
    type: "url",
    value: fieldData("bookmark-of").value or data.url,
    label: __("share.bookmark-of.label"),
    attributes: {
      "placeholder": "https://"
    },
    errorMessage: fieldData("bookmark-of").errorMessage
  }) }}

  {# Hidden url field — used by note type to pass URL to controller #}
  {{ input({
    name: "url",
    type: "hidden",
    value: data.url or fieldData("bookmark-of").value
  }) }}

  {{ input({
    name: "name",
    value: fieldData("name").value,
    label: __("share.name.label"),
    errorMessage: fieldData("name").errorMessage
  }) }}

  {{ textarea({
    name: "content",
    value: content,
    optional: true,
    label: __("share.content.label")
  }) }}

  {% if syndicationTargetItems.length %}
    {{ checkboxes({
      name: "mp-syndicate-to",
      fieldset: {
        legend: __("share.syndicate-to.label")
      },
      items: syndicationTargetItems
    }) }}
  {% endif %}

  {{ input({
    name: "access_token",
    type: "hidden",
    value: token
  }) }}

  {{ input({
    name: "h",
    type: "hidden",
    value: "entry"
  }) }}
{% endblock %}

{% block buttons %}
  {{ button({
    text: __("share.submit")
  }) if token else warningText({
    text: __("scope.none.label")
  }) }}
{% endblock %}
